{% doc %}
  @prompt
    i want to add product discount offer card here like 10% discount ,20% discount, 30% discount it add three product offer card here and add get offer details button inside the card and when i click the get offer details button then i want to display side drawe pop-up box offer details 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-discount-offers-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    padding: {{ block.settings.section_padding }}px 0;
  }

  .ai-discount-offers__container-{{ ai_gen_id }} {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .ai-discount-offers__heading-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 30px;
    font-size: {{ block.settings.heading_size }}px;
    color: {{ block.settings.heading_color }};
  }

  .ai-discount-offers__grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: {{ block.settings.card_gap }}px;
    margin-bottom: 20px;
  }

  .ai-discount-card-{{ ai_gen_id }} {
    background: {{ block.settings.card_background }};
    border: {{ block.settings.card_border_width }}px solid {{ block.settings.card_border_color }};
    border-radius: {{ block.settings.card_border_radius }}px;
    padding: 30px 20px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .ai-discount-card-{{ ai_gen_id }}:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }

  .ai-discount-card__badge-{{ ai_gen_id }} {
    display: inline-block;
    background: {{ block.settings.badge_background }};
    color: {{ block.settings.badge_text_color }};
    font-size: {{ block.settings.badge_font_size }}px;
    font-weight: 700;
    padding: 8px 16px;
    border-radius: {{ block.settings.badge_border_radius }}px;
    margin-bottom: 15px;
  }

  .ai-discount-card__title-{{ ai_gen_id }} {
    font-size: {{ block.settings.card_title_size }}px;
    color: {{ block.settings.card_title_color }};
    margin: 15px 0 10px;
    font-weight: 600;
  }

  .ai-discount-card__description-{{ ai_gen_id }} {
    font-size: {{ block.settings.card_description_size }}px;
    color: {{ block.settings.card_description_color }};
    margin-bottom: 20px;
    line-height: 1.5;
  }

  .ai-discount-card__button-{{ ai_gen_id }} {
    display: inline-block;
    background: {{ block.settings.button_background }};
    color: {{ block.settings.button_text_color }};
    padding: 12px 24px;
    border: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-size: {{ block.settings.button_font_size }}px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
    text-transform: uppercase;
  }

  .ai-discount-card__button-{{ ai_gen_id }}:hover {
    background: {{ block.settings.button_hover_background }};
  }

  .ai-discount-drawer-{{ ai_gen_id }} {
    position: fixed;
    top: 0;
    right: -100%;
    width: 100%;
    max-width: 450px;
    height: 100vh;
    background: {{ block.settings.drawer_background }};
    box-shadow: -4px 0 20px rgba(0, 0, 0, 0.2);
    z-index: 9999;
    transition: right 0.4s ease;
    overflow-y: auto;
  }

  .ai-discount-drawer-{{ ai_gen_id }}.active {
    right: 0;
  }

  .ai-discount-drawer__overlay-{{ ai_gen_id }} {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    z-index: 9998;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.4s ease, visibility 0.4s ease;
  }

  .ai-discount-drawer__overlay-{{ ai_gen_id }}.active {
    opacity: 1;
    visibility: visible;
  }

  .ai-discount-drawer__header-{{ ai_gen_id }} {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid {{ block.settings.drawer_border_color }};
  }

  .ai-discount-drawer__title-{{ ai_gen_id }} {
    font-size: 24px;
    font-weight: 700;
    color: {{ block.settings.drawer_text_color }};
    margin: 0;
  }

  .ai-discount-drawer__close-{{ ai_gen_id }} {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    color: {{ block.settings.drawer_text_color }};
  }

  .ai-discount-drawer__close-{{ ai_gen_id }} svg {
    width: 24px;
    height: 24px;
  }

  .ai-discount-drawer__content-{{ ai_gen_id }} {
    padding: 30px 20px;
  }

  .ai-discount-drawer__discount-{{ ai_gen_id }} {
    font-size: 48px;
    font-weight: 700;
    color: {{ block.settings.drawer_accent_color }};
    margin-bottom: 20px;
    text-align: center;
  }

  .ai-discount-drawer__offer-title-{{ ai_gen_id }} {
    font-size: 20px;
    font-weight: 600;
    color: {{ block.settings.drawer_text_color }};
    margin-bottom: 15px;
  }

  .ai-discount-drawer__offer-description-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.drawer_text_color }};
    line-height: 1.6;
    margin-bottom: 20px;
  }

  .ai-discount-drawer__details-{{ ai_gen_id }} {
    background: {{ block.settings.drawer_details_background }};
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
  }

  .ai-discount-drawer__details-item-{{ ai_gen_id }} {
    display: flex;
    align-items: flex-start;
    margin-bottom: 12px;
    font-size: 14px;
    color: {{ block.settings.drawer_text_color }};
  }

  .ai-discount-drawer__details-item-{{ ai_gen_id }}:last-child {
    margin-bottom: 0;
  }

  .ai-discount-drawer__details-icon-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
    margin-right: 10px;
    flex-shrink: 0;
    color: {{ block.settings.drawer_accent_color }};
  }

  .ai-discount-drawer__code-{{ ai_gen_id }} {
    background: {{ block.settings.drawer_code_background }};
    border: 2px dashed {{ block.settings.drawer_accent_color }};
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    margin-bottom: 20px;
  }

  .ai-discount-drawer__code-label-{{ ai_gen_id }} {
    font-size: 12px;
    color: {{ block.settings.drawer_text_color }};
    margin-bottom: 5px;
    text-transform: uppercase;
  }

  .ai-discount-drawer__code-value-{{ ai_gen_id }} {
    font-size: 24px;
    font-weight: 700;
    color: {{ block.settings.drawer_accent_color }};
    letter-spacing: 2px;
  }

  .ai-discount-drawer__cta-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    background: {{ block.settings.drawer_cta_background }};
    color: {{ block.settings.drawer_cta_text_color }};
    padding: 15px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    text-transform: uppercase;
    transition: background 0.3s ease;
  }

  .ai-discount-drawer__cta-{{ ai_gen_id }}:hover {
    background: {{ block.settings.drawer_cta_hover_background }};
  }

  @media screen and (max-width: 768px) {
    .ai-discount-offers__grid-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
    }

    .ai-discount-drawer-{{ ai_gen_id }} {
      max-width: 100%;
    }
  }
{% endstyle %}

<discount-offers-{{ ai_gen_id }} class="ai-discount-offers-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-discount-offers__container-{{ ai_gen_id }}">
    {% if block.settings.heading != blank %}
      <h2 class="ai-discount-offers__heading-{{ ai_gen_id }}">{{ block.settings.heading }}</h2>
    {% endif %}

    <div class="ai-discount-offers__grid-{{ ai_gen_id }}">
      {% for i in (1..3) %}
        {% liquid
          assign discount_key = 'offer_' | append: i | append: '_discount'
          assign title_key = 'offer_' | append: i | append: '_title'
          assign description_key = 'offer_' | append: i | append: '_description'
          assign details_key = 'offer_' | append: i | append: '_details'
          assign code_key = 'offer_' | append: i | append: '_code'
          assign terms_key = 'offer_' | append: i | append: '_terms'

          assign discount = block.settings[discount_key]
          assign title = block.settings[title_key]
          assign description = block.settings[description_key]
          assign details = block.settings[details_key]
          assign code = block.settings[code_key]
          assign terms = block.settings[terms_key]
        %}

        <div class="ai-discount-card-{{ ai_gen_id }}">
          <div class="ai-discount-card__badge-{{ ai_gen_id }}">{{ discount }}</div>
          <h3 class="ai-discount-card__title-{{ ai_gen_id }}">{{ title }}</h3>
          <p class="ai-discount-card__description-{{ ai_gen_id }}">{{ description }}</p>
          <button
            class="ai-discount-card__button-{{ ai_gen_id }}"
            data-offer-index="{{ i }}"
            aria-label="Get offer details for {{ title }}"
          >
            Get Offer Details
          </button>
        </div>
      {% endfor %}
    </div>
  </div>

  <div class="ai-discount-drawer__overlay-{{ ai_gen_id }}"></div>

  <div class="ai-discount-drawer-{{ ai_gen_id }}">
    <div class="ai-discount-drawer__header-{{ ai_gen_id }}">
      <h3 class="ai-discount-drawer__title-{{ ai_gen_id }}">Offer Details</h3>
      <button class="ai-discount-drawer__close-{{ ai_gen_id }}" aria-label="Close drawer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="ai-discount-drawer__content-{{ ai_gen_id }}">
      <div class="ai-discount-drawer__discount-{{ ai_gen_id }}" data-drawer-discount></div>
      <h4 class="ai-discount-drawer__offer-title-{{ ai_gen_id }}" data-drawer-title></h4>
      <p class="ai-discount-drawer__offer-description-{{ ai_gen_id }}" data-drawer-description></p>

      <div class="ai-discount-drawer__details-{{ ai_gen_id }}" data-drawer-details></div>

      <div class="ai-discount-drawer__code-{{ ai_gen_id }}">
        <div class="ai-discount-drawer__code-label-{{ ai_gen_id }}">Use Code</div>
        <div class="ai-discount-drawer__code-value-{{ ai_gen_id }}" data-drawer-code></div>
      </div>

      <div class="ai-discount-drawer__terms-{{ ai_gen_id }}" data-drawer-terms></div>

      <button class="ai-discount-drawer__cta-{{ ai_gen_id }}">Shop Now</button>
    </div>
  </div>
</discount-offers-{{ ai_gen_id }}>

<script>
  (function() {
    class DiscountOffers{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.offers = [
          {
            discount: {{ block.settings.offer_1_discount | json }},
            title: {{ block.settings.offer_1_title | json }},
            description: {{ block.settings.offer_1_description | json }},
            details: {{ block.settings.offer_1_details | json }},
            code: {{ block.settings.offer_1_code | json }},
            terms: {{ block.settings.offer_1_terms | json }}
          },
          {
            discount: {{ block.settings.offer_2_discount | json }},
            title: {{ block.settings.offer_2_title | json }},
            description: {{ block.settings.offer_2_description | json }},
            details: {{ block.settings.offer_2_details | json }},
            code: {{ block.settings.offer_2_code | json }},
            terms: {{ block.settings.offer_2_terms | json }}
          },
          {
            discount: {{ block.settings.offer_3_discount | json }},
            title: {{ block.settings.offer_3_title | json }},
            description: {{ block.settings.offer_3_description | json }},
            details: {{ block.settings.offer_3_details | json }},
            code: {{ block.settings.offer_3_code | json }},
            terms: {{ block.settings.offer_3_terms | json }}
          }
        ];
      }

      connectedCallback() {
        this.drawer = this.querySelector('.ai-discount-drawer-{{ ai_gen_id }}');
        this.overlay = this.querySelector('.ai-discount-drawer__overlay-{{ ai_gen_id }}');
        this.closeButton = this.querySelector('.ai-discount-drawer__close-{{ ai_gen_id }}');
        this.offerButtons = this.querySelectorAll('.ai-discount-card__button-{{ ai_gen_id }}');

        this.setupEventListeners();
      }

      setupEventListeners() {
        this.offerButtons.forEach((button) => {
          button.addEventListener('click', (e) => {
            const offerIndex = parseInt(e.target.getAttribute('data-offer-index')) - 1;
            this.openDrawer(offerIndex);
          });
        });

        this.closeButton.addEventListener('click', () => {
          this.closeDrawer();
        });

        this.overlay.addEventListener('click', () => {
          this.closeDrawer();
        });

        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && this.drawer.classList.contains('active')) {
            this.closeDrawer();
          }
        });
      }

      openDrawer(index) {
        const offer = this.offers[index];

        this.querySelector('[data-drawer-discount]').textContent = offer.discount;
        this.querySelector('[data-drawer-title]').textContent = offer.title;
        this.querySelector('[data-drawer-description]').textContent = offer.description;
        this.querySelector('[data-drawer-code]').textContent = offer.code;

        const detailsContainer = this.querySelector('[data-drawer-details]');
        detailsContainer.innerHTML = '';
        if (offer.details) {
          const detailsArray = offer.details.split('\n').filter(d => d.trim());
          detailsArray.forEach((detail) => {
            const item = document.createElement('div');
            item.className = 'ai-discount-drawer__details-item-{{ ai_gen_id }}';
            item.innerHTML = `
              <svg class="ai-discount-drawer__details-icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span>${detail}</span>
            `;
            detailsContainer.appendChild(item);
          });
        }

        const termsContainer = this.querySelector('[data-drawer-terms]');
        termsContainer.innerHTML = offer.terms ? `<p style="font-size: 12px; color: {{ block.settings.drawer_text_color }}; opacity: 0.7; margin-top: 15px;">${offer.terms}</p>` : '';

        this.drawer.classList.add('active');
        this.overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      closeDrawer() {
        this.drawer.classList.remove('active');
        this.overlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    customElements.define('discount-offers-{{ ai_gen_id }}', DiscountOffers{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Product discount offers",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Section"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "Special Offers"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 32
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Section padding",
      "default": 40
    },
    {
      "type": "header",
      "content": "Offer cards"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Border color",
      "default": "#e6e6e6"
    },
    {
      "type": "range",
      "id": "card_border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "card_gap",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Gap between cards",
      "default": 20
    },
    {
      "type": "range",
      "id": "card_title_size",
      "min": 14,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 20
    },
    {
      "type": "color",
      "id": "card_title_color",
      "label": "Title color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "card_description_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Description size",
      "default": 14
    },
    {
      "type": "color",
      "id": "card_description_color",
      "label": "Description color",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Badge"
    },
    {
      "type": "color",
      "id": "badge_background",
      "label": "Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "badge_text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "badge_font_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 18
    },
    {
      "type": "range",
      "id": "badge_border_radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 20
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "color",
      "id": "button_background",
      "label": "Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_background",
      "label": "Hover background",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 14
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 4
    },
    {
      "type": "header",
      "content": "Drawer"
    },
    {
      "type": "color",
      "id": "drawer_background",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "drawer_text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "drawer_border_color",
      "label": "Border color",
      "default": "#e6e6e6"
    },
    {
      "type": "color",
      "id": "drawer_accent_color",
      "label": "Accent color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "drawer_details_background",
      "label": "Details background",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "drawer_code_background",
      "label": "Code background",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "drawer_cta_background",
      "label": "CTA background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "drawer_cta_hover_background",
      "label": "CTA hover background",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "drawer_cta_text_color",
      "label": "CTA text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Offer 1"
    },
    {
      "type": "text",
      "id": "offer_1_discount",
      "label": "Discount",
      "default": "10% OFF"
    },
    {
      "type": "text",
      "id": "offer_1_title",
      "label": "Title",
      "default": "First Purchase"
    },
    {
      "type": "textarea",
      "id": "offer_1_description",
      "label": "Description",
      "default": "Get 10% off on your first order"
    },
    {
      "type": "textarea",
      "id": "offer_1_details",
      "label": "Details",
      "info": "One detail per line",
      "default": "Valid on all products\nMinimum purchase ₹500\nOne time use per customer"
    },
    {
      "type": "text",
      "id": "offer_1_code",
      "label": "Coupon code",
      "default": "FIRST10"
    },
    {
      "type": "textarea",
      "id": "offer_1_terms",
      "label": "Terms and conditions"
    },
    {
      "type": "header",
      "content": "Offer 2"
    },
    {
      "type": "text",
      "id": "offer_2_discount",
      "label": "Discount",
      "default": "20% OFF"
    },
    {
      "type": "text",
      "id": "offer_2_title",
      "label": "Title",
      "default": "Premium Members"
    },
    {
      "type": "textarea",
      "id": "offer_2_description",
      "label": "Description",
      "default": "Exclusive 20% discount for premium members"
    },
    {
      "type": "textarea",
      "id": "offer_2_details",
      "label": "Details",
      "info": "One detail per line",
      "default": "Valid on selected products\nMinimum purchase ₹1000\nCombine with other offers"
    },
    {
      "type": "text",
      "id": "offer_2_code",
      "label": "Coupon code",
      "default": "PREMIUM20"
    },
    {
      "type": "textarea",
      "id": "offer_2_terms",
      "label": "Terms and conditions"
    },
    {
      "type": "header",
      "content": "Offer 3"
    },
    {
      "type": "text",
      "id": "offer_3_discount",
      "label": "Discount",
      "default": "30% OFF"
    },
    {
      "type": "text",
      "id": "offer_3_title",
      "label": "Title",
      "default": "Bulk Orders"
    },
    {
      "type": "textarea",
      "id": "offer_3_description",
      "label": "Description",
      "default": "Save 30% on bulk purchases"
    },
    {
      "type": "textarea",
      "id": "offer_3_details",
      "label": "Details",
      "info": "One detail per line",
      "default": "Valid on orders above ₹5000\nBulk quantity required\nFree shipping included"
    },
    {
      "type": "text",
      "id": "offer_3_code",
      "label": "Coupon code",
      "default": "BULK30"
    },
    {
      "type": "textarea",
      "id": "offer_3_terms",
      "label": "Terms and conditions"
    }
  ],
  "presets": [
    {
      "name": "Product discount offers"
    }
  ]
}
{% endschema %}
