{% doc %}
  @prompt
    Create a collapsible row block for product details that displays a size chart. The block should have a clickable header that expands to reveal size chart content, match the Dawn theme styling, and be easily customizable with different size chart information. Include options to customize the heading text and content.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-collapsible-row-{{ ai_gen_id }} {
    border-top: 1px solid rgba(var(--color-border), 1);
  }

  .ai-collapsible-row-{{ ai_gen_id }}:last-child {
    border-bottom: 1px solid rgba(var(--color-border), 1);
  }

  .ai-collapsible-header-{{ ai_gen_id }} {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: {{ block.settings.vertical_padding }}px 0;
    background: none;
    border: none;
    cursor: pointer;
    text-align: left;
    color: rgba(var(--color-foreground), 1);
  }

  .ai-collapsible-header-{{ ai_gen_id }}:hover {
    color: rgba(var(--color-primary), 1);
  }

  .ai-collapsible-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.heading_size }}px;
    font-weight: 500;
    margin: 0;
    text-transform: {{ block.settings.heading_case }};
    letter-spacing: {{ block.settings.heading_letter_spacing }};
  }

  .ai-collapsible-icon-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
    transition: transform 0.3s ease;
    flex-shrink: 0;
    margin-left: 16px;
  }

  .ai-collapsible-icon-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    stroke: currentColor;
    stroke-width: {{ block.settings.icon_stroke_width }};
  }

  .ai-collapsible-header-{{ ai_gen_id }}[aria-expanded="true"] .ai-collapsible-icon-{{ ai_gen_id }} {
    transform: rotate(180deg);
  }

  .ai-collapsible-content-{{ ai_gen_id }} {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .ai-collapsible-content-{{ ai_gen_id }}.active {
    max-height: 2000px;
  }

  .ai-collapsible-inner-{{ ai_gen_id }} {
    padding-bottom: {{ block.settings.vertical_padding }}px;
    color: rgba(var(--color-foreground), 1);
    font-size: {{ block.settings.content_size }}px;
    line-height: 1.6;
  }

  .ai-collapsible-inner-{{ ai_gen_id }} table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
  }

  .ai-collapsible-inner-{{ ai_gen_id }} th,
  .ai-collapsible-inner-{{ ai_gen_id }} td {
    padding: 8px 12px;
    text-align: left;
    border: 1px solid rgba(var(--color-border), 1);
  }

  .ai-collapsible-inner-{{ ai_gen_id }} th {
    background-color: rgba(var(--color-border), 0.3);
    font-weight: 600;
  }

  .ai-collapsible-inner-{{ ai_gen_id }} p {
    margin: 0 0 12px 0;
  }

  .ai-collapsible-inner-{{ ai_gen_id }} p:last-child {
    margin-bottom: 0;
  }

  @media screen and (max-width: 749px) {
    .ai-collapsible-title-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.heading_size }}px * 0.9);
    }

    .ai-collapsible-inner-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.content_size }}px * 0.95);
    }
  }
{% endstyle %}

<collapsible-row-{{ ai_gen_id }} class="ai-collapsible-row-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <button
    class="ai-collapsible-header-{{ ai_gen_id }}"
    aria-expanded="false"
    aria-controls="ai-collapsible-content-{{ ai_gen_id }}"
  >
    <h3 class="ai-collapsible-title-{{ ai_gen_id }}">{{ block.settings.heading }}</h3>
    <span class="ai-collapsible-icon-{{ ai_gen_id }}">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </span>
  </button>
  <div
    class="ai-collapsible-content-{{ ai_gen_id }}"
    id="ai-collapsible-content-{{ ai_gen_id }}"
  >
    <div class="ai-collapsible-inner-{{ ai_gen_id }}">
      {{ block.settings.content }}
    </div>
  </div>
</collapsible-row-{{ ai_gen_id }}>

<script>
  (function() {
    class CollapsibleRow{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.button = this.querySelector('.ai-collapsible-header-{{ ai_gen_id }}');
        this.content = this.querySelector('.ai-collapsible-content-{{ ai_gen_id }}');
      }

      connectedCallback() {
        this.button.addEventListener('click', this.toggle.bind(this));
      }

      toggle() {
        const isExpanded = this.button.getAttribute('aria-expanded') === 'true';
        this.button.setAttribute('aria-expanded', !isExpanded);
        this.content.classList.toggle('active');
      }
    }

    customElements.define('collapsible-row-{{ ai_gen_id }}', CollapsibleRow{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Collapsible row",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Size Chart"
    },
    {
      "type": "html",
      "id": "content",
      "label": "Content",
      "default": "<p>Use this section to provide detailed sizing information. You can add tables, lists, or any HTML content.</p><table style=\"width: 100%; border-collapse: collapse; margin-top: 12px;\"><thead><tr><th style=\"padding: 8px 12px; text-align: left; border: 1px solid #e6e6e6; background-color: #f5f5f5; font-weight: 600;\">Size</th><th style=\"padding: 8px 12px; text-align: left; border: 1px solid #e6e6e6; background-color: #f5f5f5; font-weight: 600;\">Chest (in)</th><th style=\"padding: 8px 12px; text-align: left; border: 1px solid #e6e6e6; background-color: #f5f5f5; font-weight: 600;\">Waist (in)</th><th style=\"padding: 8px 12px; text-align: left; border: 1px solid #e6e6e6; background-color: #f5f5f5; font-weight: 600;\">Hip (in)</th></tr></thead><tbody><tr><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">XS</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">32-34</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">24-26</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">34-36</td></tr><tr><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">S</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">34-36</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">26-28</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">36-38</td></tr><tr><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">M</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">36-38</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">28-30</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">38-40</td></tr><tr><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">L</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">38-40</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">30-32</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">40-42</td></tr><tr><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">XL</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">40-42</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">32-34</td><td style=\"padding: 8px 12px; border: 1px solid #e6e6e6;\">42-44</td></tr></tbody></table>"
    },
    {
      "type": "header",
      "content": "Heading style"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Size",
      "default": 14
    },
    {
      "type": "select",
      "id": "heading_case",
      "label": "Text case",
      "options": [
        {
          "value": "none",
          "label": "Default"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        }
      ],
      "default": "none"
    },
    {
      "type": "select",
      "id": "heading_letter_spacing",
      "label": "Letter spacing",
      "options": [
        {
          "value": "normal",
          "label": "Normal"
        },
        {
          "value": "0.05em",
          "label": "Loose"
        }
      ],
      "default": "normal"
    },
    {
      "type": "header",
      "content": "Content style"
    },
    {
      "type": "range",
      "id": "content_size",
      "min": 12,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Size",
      "default": 14
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "vertical_padding",
      "min": 12,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Vertical padding",
      "default": 16
    },
    {
      "type": "range",
      "id": "icon_stroke_width",
      "min": 1,
      "max": 3,
      "step": 0.5,
      "unit": "px",
      "label": "Icon stroke width",
      "default": 1.5
    }
  ],
  "presets": [
    {
      "name": "Collapsible row"
    }
  ]
}
{% endschema %}